p= link_to 'Back', root_path, class: 'waves-effect waves-light btn'

h3 New Event

.row
  = form_for @event, url: { action: 'create' }, html: { class: 'col s12' } do |f|
    ul.tabs
      li.tab.col.s3
        a href="#what" What
      li.tab.col.s3
        a href="#who" Who
      li.tab.col.s3
        a href="#where" Where
      li class="tab col s3"
        a href="#when" When
      li class="tab col s3"
        a href="#start" Start
    #what.col.s12
      .row
        .input-field.col.s12
          = f.text_field :name
          = f.label :name
    #who.col.s12
      .row
        .input-field.col.s12
          = f.select :user_ids, current_user.contacts_for_select, {}, class: 'chosen-select', multiple: true, data: { placeholder: "Who" }
    #where.col.s12
      .row
        .input-field.col.s12
          = text_field_tag :search, '', id: 'address'
          = label_tag :search
      #map

    #when.col.s12
      p When
      .row#dates-add-form
        .input-field.col.m3
          = date_field_tag :event_start_at, '', { class: 'datepicker' }
        .input-field.col.m3
          = time_field_tag :event_start_at_time, '', { ignore_date: true }
        .input-field.col.m3
          = link_to '#', id: 'add-dates', class: "btn" do
            i class="material-icons" add
        #selected-dates.col.s12
      //TODO Remove below line
      - if current_user.calendars.first
        iframe frameborder="0" height="600" scrolling="no" src="//www.google.com/calendar/embed?src=#{current_user.calendars.first.google_id}" style="border: 0" width="800"
    #start.col.s12
      .row
        p Will invite [TODO] to [TODO] on [TODO]
      .row
        .col.s12
          = f.submit 'Save', class: 'waves-effect waves-light btn'


javascript:
  $( document ).ready(function() {
    $( "#address" ).on('input propertychange paste', function() {
      GMaps.geocode({
        address: $(this).val(),
        callback: function(results, status) {
          if (status == 'OK') {
            var latlng = results[0].geometry.location;
            map.setCenter(latlng.lat(), latlng.lng());
          }
        }
      });
    });

    map = new GMaps({
      div: '#map',
      lat: -12.043333,
      lng: -77.028333
    });

    GMaps.on('click', map.map, function(event) {
      var index = map.markers.length;
      var lat = event.latLng.lat();
      var lng = event.latLng.lng();

      map.addMarker({
        lat: lat,
        lng: lng,
        title: 'Marker #' + index,
        infoWindow: {
          content : "TODO"
        }
      });
    });
  });
